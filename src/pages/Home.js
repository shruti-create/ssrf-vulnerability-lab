import React, { useState, useEffect } from "react";
import "react-calendar/dist/Calendar.css";

const Home = (userData) => {
  const [todoPayment, setTodoPayment] = useState("");
  const [todoJob, setTodoJob] = useState("");
  const [todoContact, setTodoContact] = useState("");
  const [todos, setTodos] = useState([]);


  useEffect(() => {
    const savedTodos = JSON.parse(localStorage.getItem("todos")) || [];
    setTodos(savedTodos);
  }, []);

  const handleTodoSubmit = (e) => {
    e.preventDefault();
    if (todoPayment.trim() === "" || todoJob.trim() === "" || todoContact.trim() === "") return;

    const newTodo = { payment: todoPayment, job: todoJob, contact: todoContact, };
    setTodos([...todos, newTodo]);
    localStorage.setItem("todos", JSON.stringify([...todos, newTodo]));
    setTodoPayment("");
    setTodoJob("");
    setTodoContact("");
  };

  const removeTodo = (index) => {
    const updatedTodos = [...todos];
    updatedTodos.splice(index, 1);
    setTodos(updatedTodos);
    localStorage.setItem("todos", JSON.stringify(updatedTodos));
  };

  return (
    <section className="vh-100" style={{ paddingLeft: "15px", paddingTop: "20px", backgroundColor: "#555555", overflowY: "auto" }}>
      <div className="container h-100">
        <div className="flex-grow-1 row d-flex justify-content-top align-items-left h-100">
          <div className="col col-xl-3">
            <div className="card" style={{ borderRadius: "15px", height: "620px" }}>
              <div className="card-body p-4">
                <h6 className="mb-3">Post Jobs</h6>
                <form onSubmit={handleTodoSubmit}>
                  <div className="mb-3">
                    <label htmlFor="todoPayment" className="form-label">Payment Amount:</label>
                    <input
                      type="text"
                      id="todoPayment"
                      className="form-control"
                      value={todoPayment}
                      onChange={(e) => setTodoPayment(e.target.value)}
                    />
                  </div>
                  <div className="mb-3">
                    <label htmlFor="todoJob" className="form-label">Job Description:</label>
                    <input
                      type="text"
                      id="todoJob"
                      className="form-control"
                      value={todoJob}
                      onChange={(e) => setTodoJob(e.target.value)}
                    />
                  </div>
                  <div className="mb-3">
                    <label htmlFor="todoContact" className="form-label">Contact Information:</label>
                    <input
                      type="text"
                      id="todoContact"
                      className="form-control"
                      value={todoContact}
                      onChange={(e) => setTodoContact(e.target.value)}
                    />
                  </div>
                  <button type="submit" style={{ backgroundColor: "#999999" }} className="btn btn-lg">
                    Add
                  </button>
                </form>
              </div>
            </div>
          </div>
          <div className="col col-xl-6">
            <div className="card" style={{ borderRadius: "15px", height: "620px"}}>
              <div className="card-body p-4">
                <h6 className="mb-3">Available Jobs</h6>
                <h7 className="mb-3">These are the current available jobs. Contact the poster with the contact information to accept.</h7>
                <ul className="list-group mb-0" style={{ maxHeight: "490px", overflowY: "auto" }}>
                  {todos.map((todoItem, index) => (
                    <li
                      key={index}
                      className="list-group-item d-flex justify-content-between align-items-center border-start-0 border-top-0 border-end-0 border-bottom rounded-0 mb-2"
                    >
                      <div className="d-flex align-items-center">
                        {todoItem.job} | Payment: ${todoItem.payment} | Contact: {todoItem.contact}
                      </div>
                    </li>
                  ))}
                </ul>
              </div>
            </div>
            </div>
          <div className="col col-xl-3">
            <div className="card" style={{ borderRadius: "15px", height: "620px", width: "290px" }}>
              <div className="card-body p-4">
                <h6 className="mb-3">Modify Available Jobs</h6>
                <ul className="list-group mb-0" style={{ maxHeight: "550px", overflowY: "auto" }}>

                  {todos.map((todoItem, index) => (
                    <li
                      key={index}
                      className="list-group-item d-flex justify-content-between align-items-center border-start-0 border-top-0 border-end-0 border-bottom rounded-0 mb-2"
                    >
                      <div>
                        <strong>Payment:</strong> ${todoItem.payment} | <strong>Job:</strong> {todoItem.job} | <strong>Contact:</strong> {todoItem.contact}
                      </div>
                      <button
                        type="button"
                        className="btn btn-sm"
                        onClick={() => removeTodo(index)}
                      >
                        X
                      </button>
                    </li>
                  ))}
                  </ul>
              </div>
          </div>
          </div>
        </div>
      </div>
    </section>
  );
};

export default Home;
